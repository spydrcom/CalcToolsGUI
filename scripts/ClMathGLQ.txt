

//* GLQ test attempting to build GAMMA


configure QUAD method "GAUSS" type "LAGUERRE" description "custom quadrature using Gauss-Laguerre"
configure QUAD order "25" hi "100" show "lists" using "L20"
instance GLQ QUAD


!! G (x) = GLQ [ 0 < t < INFINITY ] ( t^(x-1) * <*> t ) ; express G


calc G (4)
calc G (5)


graph [  1 < x < 5 <> 0.05  ] ( GAMMA(x),  G(x) )

graph [  1 < x < 5 <> 0.05  ] ( GAMMA(x) - G(x) ) 

graph [ 0.1 < x < 5 <> 0.05 ] ( GAMMA(x),  G(x) ) 

graph [ 0.1 < x < 5 <> 0.05 ] ( GAMMA(x) - G(x) )  

RENDERF G


!! Z (x) = 1/G(x) * GLQ [ 0 < t < INFINITY ] ( t^(x-1) / (1-exp(-t)) * <*> t ) ; express Z

RENDERF Z


// z = [0.1 <= t <= 20 <> 0.1] (zeta t)
// using MPMATH.zeta in the Anaconda complex version of CalcTools
z = (-0.6030375198562418, -0.7339209248963406, -0.9045592572539841, -1.1347977838669816, -1.4603545088095868, -1.9526614482240006, -2.7783884455536954, -4.437538415895549, -9.430114019402243, -9.007199254740991E15, 10.584448464950823,  5.591582441177752,  3.9319492118095436,   3.1055472779775797,  2.6123753486854873,    2.285765665680129,   2.0542887568377504,    1.8822296181028213,  1.7497464351250602,  1.644934066848226, 1.5602165335033618, 1.490543256506893, 1.4324177993153233, 1.3833428588407353, 1.3414872572509169, 1.3054778090727803, 1.2742646444436796, 1.247031422317253, 1.223133895304355, 1.202056903159594, 1.183383652111906, 1.1667733709844668, 1.1519447947207735, 1.1386637757280416, 1.1267338673170564, 1.1159890791233376, 1.106288241464679, 1.097510576459004, 1.0895521846703211, 1.0823232337111381, 1.0757456903435034, 1.0697514772338093, 1.06428096432584, 1.0592817259798355, 1.0547075107614543, 1.0505173825665735, 1.0466750006991312, 1.043148013335179, 1.0399075440493561, 1.03692775514337, 1.0341854746874897, 1.0316598766779166, 1.0293322056832195, 1.027185538920354, 1.0252045799546858, 1.02337547922703, 1.0216856774262202, 1.0201237683883446, 1.0186793787447406, 1.0173430619844492, 1.01610620496221, 1.014960945185223, 1.0139000974628078, 1.012917088712184, 1.0120058998885249, 1.011161014154271, 1.010377370526381, 1.009650322344712, 1.0089755999933343, 1.008349277381923, 1.0077677417586204, 1.0072276664807172, 1.0067259864166136, 1.0062598756930512, 1.005826727536523, 1.0054241359879634, 1.005049879295965, 1.0047019048164696, 1.0043783152666528, 1.0040773561979444, 1.0037974045681957, 1.0035369583062013, 1.0032946267733605, 1.0030691220374448, 1.0028592508824157, 1.0026639074861505, 1.00248206670494, 1.002312777909822, 1.0021551593253255, 1.0020083928260823, 1.0018717191511275, 1.0017444334995897, 1.0016258814749373, 1.0015154553480514, 1.0014125906121736, 1.0013167628052648, 1.0012274845775486, 1.0011443029840295, 1.001066796983578, 1.0009945751278182, 1.0009272734245156, 1.0008645533615088, 1.0008061000784172, 1.000751620674465, 1.000700842641736, 1.000653512414085, 1.0006093940227343, 1.0005682678503411, 1.000529929475981, 1.0004941886041194, 1.0004608680712006, 1.0004298029239944, 1.0004008395643103, 1.0003738349551166, 1.0003486558834918, 1.0003251782761946, 1.0003032865639692, 1.000282873090999, 1.000263837566201, 1.000246086553308, 1.0002295329969138, 1.000214095781875, 1.0001996993236588, 1.0001862731874056, 1.000173751733643, 1.000162073788746, 1.0001511823383673, 1.000141024242209, 1.0001315499686152, 1.0001227133475785, 1.0001144713408605, 1.0001067838280169, 1.0000996134072075, 1.0000929252097515, 1.0000866867274623, 1.000080867651872, 1.0000754397245069, 1.0000703765974504, 1.000065653703472, 1.0000612481350588, 1.0000571385317307, 1.0000533049750668, 1.0000497288909065, 1.0000463929582293, 1.0000432810242568, 1.0000403780253397, 1.0000376699132394, 1.0000351435864272, 1.0000327868260597, 1.000030588236307, 1.0000285371887374, 1.0000266237704787, 1.000024838735898, 1.0000231734615617, 1.000021619904246, 1.0000201705617975, 1.000018818436641, 1.000017557001761, 1.0000163801689845, 1.0000152822594086, 1.0000142579758295, 1.0000133023770335, 1.000012410853827, 1.0000115791066833, 1.0000108031249002, 1.0000100791671644, 1.000009403743427, 1.0000087735980012, 1.0000081856938, 1.0000076371976379, 1.0000071254665213, 1.0000066480348633, 1.000006202602561, 1.0000057870238737, 1.0000053992970512, 1.000005037554661, 1.0000047000545642, 1.0000043851715013, 1.0000040913892423, 1.000003817293265, 1.0000035615639271, 1.0000033229700953, 1.0000031003632044, 1.000002892671715, 1.000002698895944, 1.000002518103242, 1.0000023494234949, 1.0000021920449285, 1.000002045210194, 1.0000019082127165, 1.000001780393289, 1.0000016611368951, 1.0000015498697448, 1.0000014460565094, 1.0000013491977429, 1.0000012588274738, 1.0000011745109625, 1.0000010958426055, 1.0000010224439826) 
//                     0                    1                    2                    3                    4                    5                    6                   7                   8                      9                  10                  11                   12                    13                   14                    15                    16                     17                   18                  19                  20                 21                  22                  23                  24                  25                  26                 27                 28                 29                 30                  31                  32                  33                  34                  35                 36                 37                  38                  39                  40
//   (10.647845039789287,  10.136948446355573,   9.629483002511984,   9.158132134875746,   8.773872241295043,   8.564571010942144,    8.71299230620176,  9.733382042626147,  14.13692934483453,  9.007199254740996E15, -6.880616224208801, -2.298055530405535, -0.9906089599328514, -0.46291100033770505, -0.2207165150260182, -0.10354697541474689, -0.04608241432762128, -0.018299352509349553, -0.0054401339537530, -4.51527704115E-12, 0.0018795529308031, 0.002166504041547, 0.0018371383029847, 0.0013499340711868, 8.9865905970309E-4, 5.4737027678486E-4, 3.0132241896674E-4, 1.430269267388E-4, 4.955677388984E-5, -3.5189628988E-12, -2.20420772789E-5, -2.826622076668E-5, -2.640406504417E-5, -2.119870118177E-5, -1.531360252271E-5, -1.006276490911E-5, -5.94633258410E-6, -3.01673272296E-6, -1.112968650796E-6, -9.29500920676E-12, 5.5586523717288E-7, 7.5228007467842E-7, 7.39863735610E-7, 6.2407257206409E-7, 4.7272665781861E-7, 3.2515703041191E-7, 2.0080222196128E-7, 1.063053891581E-7, 4.0869614581495E-8, -9.408029910E-13, -2.208638893996E-8, -3.103747037158E-8, -3.166350914796E-8, -2.76760849793E-8, -2.170236634846E-8, -1.5436906419E-8, -9.845941617570E-9, -5.372600142550E-9, -2.115873698471E-9, 2.758571149286E-11, 1.25990617938E-9, 1.812388017441E-9, 1.9032475595537E-9, 1.715714459393E-9, 1.3901355622181E-9, 1.024847762209E-9, 6.81863898677E-10, 3.94585919494E-10, 1.757161083304E-10, 2.43352005213E-11, -6.83415546376E-11, -1.14672937812E-10, -1.27639676605E-10, -1.19041221324E-10, -9.8556274252E-11, -7.34434735250E-11, -4.8639314798E-11, -2.70896638454E-11, -1.01834096710E-11, 1.807665128694E-12, 9.327871808295E-12, 1.321032172540E-11, 1.443312136473E-11, 1.394595550152E-11, 1.2568834861781397E-11, 1.0943246309125243E-11, 9.516387677876992E-12, 8.559375430650107E-12, 8.192557743313955E-12, 8.422373909411363E-12, 9.175105120107219E-12, 1.0329515021112456E-11, 1.1743050976065206E-11, 1.3272272170183896E-11, 1.4785506152747985E-11, 1.6174395156554056E-11, 1.7354118142520747E-11, 1.826694351336755E-11, 1.8879120489145862E-11, 1.917954683960943E-11, 1.9173995724486304E-11, 1.8882007069009887E-11, 1.833400098405491E-11, 1.7565060517199527E-11, 1.6616485964959793E-11, 1.552935557924684E-11, 1.4343193299737322E-11, 1.3097301021502972E-11, 1.1827205881331793E-11, 1.0565104346937915E-11, 9.339196083146817E-12, 8.171463505846077E-12, 7.083222897108499E-12, 6.0880189778345084E-12, 5.197176022875283E-12, 4.418465593403198E-12, 3.753219957047804E-12, 3.2018832030189515E-12, 2.7613467068476893E-12, 2.426059353410892E-12, 2.1873614031164834E-12, 2.035482893347762E-12, 1.9606538614880265E-12, 1.94932958663685E-12, 1.9908519277578307E-12, 2.071676163950542E-12, 2.1811441541785825E-12, 2.3072654897760003E-12, 2.440714297335944E-12, 2.5714985696367876E-12, 2.6925128793209296E-12, 2.7973179328455444E-12, 2.8810287489022812E-12, 2.9407587476271146E-12, 2.9733993045510942E-12, 2.977840196649595E-12, 2.9551916469472417E-12, 2.9063418338637348E-12, 2.8332891588433995E-12, 2.738032023330561E-12, 2.625233364028645E-12, 2.496669537777052E-12, 2.3561153028595072E-12, 2.2084556405843614E-12, 2.0548007739762397E-12, 1.899813639738568E-12, 1.7470469515501463E-12, 1.5978329770405253E-12, 1.453948073049105E-12, 1.318944953254686E-12, 1.1928236176572682E-12, 1.0769163338864018E-12, 9.71445146547012E-13, 8.772982340587987E-13, 7.94475596421762E-13, 7.214229214014267E-13, 6.590283874174929E-13, 6.055156376305604E-13, 5.606626274357041E-13, 5.233591338082988E-13, 4.918287999089443E-13, 4.669598041573408E-13, 4.4653170050423796E-13, 4.289901767151605E-13, 4.150013666048835E-13, 4.030109579389318E-13, 3.921307722976053E-13, 3.8191672047105385E-13, 3.7259084706420253E-13, 3.630429290524262E-13, 3.530509218307998E-13, 3.423927807943983E-13, 3.319566843629218E-13, 3.197442310920451E-13, 3.0730973321624333E-13, 2.944311461305915E-13, 2.8110846983508964E-13, 2.6711965972481266E-13, 2.5290880500961066E-13, 2.384759056894836E-13, 2.2426505097428162E-13, 2.1027624086400465E-13, 1.965094753586527E-13, 1.829647544582258E-13, 1.7008616737257398E-13, 1.5787371410169726E-13, 1.461053500406706E-13, 1.3522516439934407E-13, 1.254552017826427E-13, 1.1590728377086634E-13, 1.0702549957386509E-13, 9.9253938401489E-14, 9.192646643896296E-14, 8.593126210598712E-14, 7.971401316808624E-14, 7.460698725481052E-14, 6.972200594645983E-14, 6.572520305780927E-14, 6.217248937900877E-14)

// using Z function defined above
Zx = [0.1 <= t <= 20 <> 0.1] (Z t)    


// plots show the differences decrease as x increases

graph LIM 10 [0<=n<= LENGTH z - 1] ( Zx#n - z#n)   

graph LIM 1 [30<=n<= LENGTH z - 1] ( Zx#n - z#n)  

graph LIM 1 [20<=n<= LENGTH z - 1] ( Zx#n - z#n)  

graph LIM 1 [50<=n<= LENGTH z - 1] ( Zx#n - z#n)  

