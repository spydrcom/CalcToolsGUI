

//* VC quad testing


z0 = 1.5+10.0*i
//z0 = 0.5+10.0*i
z1 = 0.5+14.0*i ; z5 = 5 + 5*i
z1g = -4.0537030780372815e-10 -i*5.7732998345536051e-10
z5g = -0.97439524180523907 + i*2.0066898827226298
INFINITY = 16


!! ig(x,t) = exp(-t) * t^(x-1)
RENDERF ig

!! igz (t) = ig(z0,t)
// !! igz (t) = ig(z5,t)
plotri igz [0 < x < INFINITY <> 0.01]


configure QUAD method "TSQ" description "custom quadrature using Tanh-Sinh"
instance TSQ QUAD


!! Gts (x) = TSQ [ 0 < t < INFINITY ] ( ig(x,t) * <*> t ) ; express Gts
RENDERF Gts

Gzts = Gts z5
prettyprint Gzts


configure QUAD method "CCQ" description "custom quadrature using Clenshaw-Curtis"
instance CCQ QUAD


!! Gcc (x) = CCQ [ 0 < t < INFINITY ] ( ig(x,t) * <*> t ) ; express Gcc
RENDERF Gcc

Gzcc = Gcc z5
prettyprint Gzcc


configure QUAD method "CTA" description "custom quadrature using Trap Approx"
configure QUAD delta "0.005"
instance CTA QUAD


!! Gta (x) = CTA [ 0.001 < t < INFINITY ] ( ig(x,t) * <*> t ) ; express Gta
RENDERF Gta

Gzta = Gta z5
prettyprint Gzta


configure QUAD method "VCQ" description "custom quadrature using VC Approx"
configure QUAD delta "0.005"
instance VCQ QUAD


!! Gvc (x) = VCQ [ 0 <= t <= 1 ] ( ig(x,t) * <*> t ) ; express Gvc

Gzvc = Gvc z5
prettyprint Gzvc
Gsum = Gzvc
prettyprint Gsum


!! Gvc1 (x) = VCQ [ 1 <= t <= 3 ] ( ig(x,t) * <*> t ) ; express Gvc1

Gzvc1 = Gvc1 z5
prettyprint Gzvc1
Gsum = Gsum + Gzvc1
prettyprint Gsum


!! Gvc2 (x) = VCQ [ 3 <= t <= 8 ] ( ig(x,t) * <*> t ) ; express Gvc2

Gzvc2 = Gvc2 z5
prettyprint Gzvc2
Gsum = Gsum + Gzvc2
prettyprint Gsum

!! Gvc3 (x) = VCQ [ 8 <= t <= 15 ] ( ig(x,t) * <*> t ) ; express Gvc3

Gzvc3 = Gvc3 z5
prettyprint Gzvc3
Gsum = Gsum + Gzvc3
prettyprint Gsum

!! Gvc4 (x) = VCQ [ 15 <= t <= 60 ] ( ig(x,t) * <*> t ) ; express Gvc4

Gzvc4 = Gvc4 z5
prettyprint Gzvc4
Gsum = Gsum + Gzvc4
prettyprint Gsum



 rc = (-0.3970372270865141, -1.251228345402564, -2.265677750052326, 0.04752614506102596, 1.8968790782392662, -0.5667199631704222, -0.4556319410738853, 0.34516998093229606, -0.05371407336987389, -0.03927997063442141, 0.02725695029722214, -0.007484633170429185, 1.0354278395083599E-4, 8.507938669093865E-4, -4.400357322247979E-4, 1.3363880715498017E-4, -2.4139892915414206E-5, -5.306063183542426E-7, 2.591706262608305E-6, -1.3219037598419715E-6, 4.774652704963363E-7, -1.340200682692275E-7, 3.331867814036918E-8, -1.0567342447143461E-8, 3.066952923833386E-9, -2.7235103957852715E-9, 4.7040991487845E-10, 1.1244925415016855E-9, -3.990607500775619E-10, -5.289422942537933E-11, 2.4495207845291524E-11)
 ic = (0.8653201494297349, 1.1906439915325404, -0.29950717532188426, -2.410822668573234, 0.3280454046181781, 1.1205227271200116, -0.5388909510621749, -0.0763227484263961, 0.1523806701116508, -0.05615408470797214, 0.0019376902605405513, 0.007149544933873161, -0.003755071406118453, 0.001003610327388919, -8.201518769786098E-5, -6.527405624880168E-5, 4.208183812402638E-5, -1.5580349323539607E-5, 4.2157868639112624E-6, -7.752095826818313E-7, 3.30248388941491E-8, 6.09461178927436E-8, -3.3562048423338843E-8, 8.846516718556471E-9, -2.719932884162561E-9, -1.4245283216442973E-9, -3.1148903497253464E-11, 1.457034892065376E-9, -3.4884275053567074E-10, -1.4508462300266307E-10, 4.229807639195058E-11)

!! rp(x) = rc @*^ x
!! ip(x) = ic @*^ x

!! p1(x) = rp(x) + ip(x) * i

plotri p1 [ -1.5 <= t <= 1.5 <> 0.01 ]

 rc = (0.11423021629138094, -0.08952516842119827, -0.038329375355097395, 0.0435060031215867, -0.016540195513260598, 0.0031389562829455676, -1.0945845326492154E-4, -1.1166251108818739E-4, 3.54885756726884E-5, -5.622393942893807E-6, 3.741778901209127E-7, 5.461459392557985E-8, -2.0931561431066304E-8, 3.4504839477827038E-9, -3.3493641546527285E-10, 8.648820788333262E-12, 3.733794345384102E-12, -8.734696840478301E-13, 1.162794277001456E-13, -1.0275490167429128E-14, 2.2450838281295514E-16, 1.0191422614294819E-16, 4.600413385136246E-17, -1.0079076492464775E-16, 5.947715259607914E-17, 3.4650793152421124E-17, -2.782429698245504E-17, -4.706386295633708E-18, 4.223617493600704E-18, 2.302916873964305E-19, -2.1868983007019254E-19)
 ic = (-0.17946696911522705, 0.31508397357584733, -0.15334382875055494, 0.036039597021684446, 3.1693091993998976E-5, -0.002771343460946886, 9.375958416500148E-4, -1.57628777653298E-4, 8.14377286314481E-6, 3.043658525898012E-6, -9.86361508074672E-7, 1.5540829022107057E-7, -1.2694158766023479E-8, -4.4655411544191814E-10, 3.36636038551238E-10, -6.186457582837854E-11, 7.011909354006078E-12, -4.431539326794703E-13, -1.4446801609885032E-14, 8.985729806937046E-15, -1.2615674288375807E-15, 1.758485451951026E-16, 1.031139917958419E-17, -4.214637527279269E-17, -1.3368270828379826E-16, 1.5619962540057028E-17, 5.082516680535502E-17, -2.1841979560052918E-18, -7.279238474122052E-18, 1.0826936456676495E-19, 3.670312176117117E-19)

!! rp(x) = rc @*^ x
!! ip(x) = ic @*^ x

!! p2(x) = rp(x) + ip(x) * i

plotri p2 [ -1.5 <= t <= 1.5 <> 0.01 ]

