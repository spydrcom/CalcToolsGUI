

//* VC quad testing


z1 = 0.5+14.0*i ; z5 = 5 + 5*i
z1g = -4.0537030780372815e-10 -i*5.7732998345536051e-10
z5g = -0.97439524180523907 + i*2.0066898827226298
INFINITY = 20


!! ig(x,t) = exp(-t) * t^(x-1)
RENDERF ig

!! igz (t) = ig(z5,t)
plotri igz [0 < x < INFINITY <> 0.01]


configure QUAD method "TSQ" description "custom quadrature using Tanh-Sinh"
instance TSQ QUAD


!! Gts (x) = TSQ [ 0 < t < INFINITY ] ( ig(x,t) * <*> t ) ; express Gts
RENDERF Gts

Gzts = Gts z5
prettyprint Gzts


configure QUAD method "CCQ" description "custom quadrature using Clenshaw-Curtis"
instance CCQ QUAD


!! Gcc (x) = CCQ [ 0 < t < INFINITY ] ( ig(x,t) * <*> t ) ; express Gcc
RENDERF Gcc

Gzcc = Gcc z5
prettyprint Gzcc


configure QUAD method "CTA" description "custom quadrature using Trap Approx"
configure QUAD delta "0.005"
instance CTA QUAD


!! Gta (x) = CTA [ 0.001 < t < INFINITY ] ( ig(x,t) * <*> t ) ; express Gta
RENDERF Gta

Gzta = Gta z5
prettyprint Gzta


configure QUAD method "VCQ" description "custom quadrature using VC Approx"
configure QUAD delta "0.005"
instance VCQ QUAD


!! Gvc (x) = VCQ [ 0 < t <= INFINITY ] ( ig(x,t) * <*> t ) ; express Gvc
RENDERF Gvc

Gzvc = Gvc z5
prettyprint Gzvc


 rc = (0.7672704948342588, 1.815349877413618, 1.8859629253296373, 0.5176195950582059, -0.7172705184996089, -0.1792382476738174, 0.19374751400537787, -0.015048639611173555, -0.024640221033630363, 0.010615138748960938, -0.001224287146176966, -6.15560299603461E-4, 3.84072110088576E-4, -1.1494953681416052E-4, 1.9130675105051765E-5, 8.174689345837719E-7, -2.038040231685715E-6, 9.605548839085941E-7, -3.2365333280565267E-7, 8.73911986024154E-8, -1.9315259797242807E-8, 2.3772778394648602E-9, 1.2784325552919202E-10, 8.365412460779903E-11, -4.160541743514441E-11, 1.899812459404625E-10, -2.617406111170383E-11, -1.0627437775624516E-10, 3.245656568492421E-11, 7.510672802815845E-12, -2.673246436031422E-12)
 ic = (-1.0438766360757756, -1.4655556066506017, 0.06990764987664749, 1.2535776299092292, 0.40750320698618014, -0.39050018430537214, -0.036479058818593875, 0.0803651581303419, -0.019283003446585914, -0.003675217162047603, 0.0036345669018699013, -0.0010984940422681152, 1.164980728295419E-4, 4.955263591200016E-5, -3.336560669738501E-5, 1.1679076066962599E-5, -2.901626038880915E-6, 4.746552373436466E-7, 1.0021355055291379E-9, -4.178376919433202E-8, 2.2274959279048204E-8, -8.828374398652506E-9, 2.838842989583946E-9, -6.797625655238248E-10, 1.7883941303244514E-10, 2.6873552038551627E-11, 7.500687710129972E-12, -4.868845875430902E-11, 8.232125389843543E-12, 6.672110262109526E-12, -1.6897669673609336E-12)

!! rp(x) = rc @*^ x
!! ip(x) = ic @*^ x

!! p(x) = rp(x) + ip(x) * i

plotri p [ -1.5 <= t <= 1.5 <> 0.01 ]

